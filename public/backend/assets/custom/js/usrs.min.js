"use strict";$((function(){let e=$("#dataTableUsers").DataTable({processing:!0,serverSide:!0,ajax:{url:getDataFromUsersURL,type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}},columns:[{data:"id",visible:!1},{data:"name"},{data:"email"},{data:"email_verified_at",render:function(e){return e&&""!==e&&null!==e?'<span class="badge bg-success">Verified</span>':'<span class="badge bg-danger">Unverified</span>'}},{data:"roles",render:function(e){return"Administrator"===e?`<span class="badge bg-success"> ${e} </span>`:"User"===e?`<span class="badge bg-primary"> ${e} </span>`:`<span class="badge bg-warning"> ${e} </span>`}},{data:"created_at",render:function(e){return moment(e).format("YYYY-MM-DD HH:mm:ss")}},{data:"updated_at",render:function(e){return moment(e).format("YYYY-MM-DD HH:mm:ss")}},{data:"roles",render:function(e){return e&&""!==e&&null!==e?'<td class="text-right py-0 align-middle">\n                        <div class="btn-group btn-group-sm">\n                        <a class="btn btn-warning" id="btnRemove" title="Remove role"><i class="fas fa-user-times"></i></a>\n                        <a class="btn btn-danger" id="btnDelete" title="Delete user"><i class="fas fa-user-slash"></i></a>\n                        </div>\n                        </td>':'<td class="text-right py-0 align-middle">\n                        <div class="btn-group btn-group-sm">\n                        <a class="btn btn-info" id="btnAssign" title="Assign role"><i class="fas fa-user-check"></i></a>\n                        <a class="btn btn-danger" id="btnDelete" title="Delete user"><i class="fas fa-user-slash"></i></a>\n                        </div>\n                        </td>'}}],paging:!0,lengthChange:!0,searching:!0,ordering:!0,info:!0,autoWidth:!0,lengthMenu:[10,20,30,40,50],scrollX:!0});$(document).on("click","#btnAssign",(function(t){let a=$(this).closest("tr"),s=e.row(a).data().id;$.ajax({url:`${editUsersURL}/${s}`,type:"GET",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){$("#modal-edit-users").modal("show"),$("#id").val(e.id),$("#name").val(e.name),$("#email").val(e.email),$("#roles").val(e.roles)},error:function(e){Swal.fire({icon:"error",title:"Error",text:e.responseJSON.errors})}})})),$("#formUser").submit((function(t){t.preventDefault();let a=$("#formUser")[0],s=new FormData(a),n=s.get("id");if(this.checkValidity()&&n){let t={roles:s.get("roles")};$.ajax({url:`${updateUsersURL}/${n}`,type:"PUT",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:t,dataType:"JSON",success:function(t){Swal.fire({icon:"success",title:"Success",text:"User role was successfully assigned."}).then((()=>{e.ajax.reload(),$("#modal-edit-users").modal("hide")}))},error:function(e){Swal.fire({icon:"error",title:"Error",text:e.responseJSON.errors})}})}})),$(document).on("click","#btnRemove",(function(t){let a=$(this).closest("tr"),s=e.row(a).data().id;Swal.fire({title:"Are you sure?",text:"You will not be able to revert this.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, remove it!"}).then((t=>{if(t.isConfirmed){let t=null;$.ajax({url:`${removeUserURL}/${s}`,type:"PUT",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:t,dataType:"JSON",success:function(t){Swal.fire({icon:"success",title:"Success",text:t.removed}).then((()=>{e.ajax.reload()}))},error:function(e){Swal.fire({icon:"error",title:"Error",text:e.responseJSON.errors})}})}}))})),$(document).ready((function(){$(".needs-validation").each((function(){$(this).on("submit",(function(e){!1===this.checkValidity()&&(e.preventDefault(),e.stopPropagation()),$(this).addClass("was-validated")}))}))})),$("#modal-edit-users").on("hidden.bs.modal",(function(e){$("#id").val(""),$("#name").val(""),$("#email").val(""),$("#role").val("")}))}));